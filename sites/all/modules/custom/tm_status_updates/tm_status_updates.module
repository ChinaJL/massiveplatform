<?php
/**
 * @file
 * Code for the TM Status Updates feature.
 */

// tm_status_updates.module - status updates

include_once 'tm_status_updates.features.inc';
include_once 'tm_status_updates.install';
include_once 'tm_status_updates.builder.inc';
include_once 'tm_status_updates.controller.inc';
include_once 'tm_status_updates.display.inc';
include_once 'tm_status_updates.handle_update.inc';
include_once 'tm_status_updates.handle_edit.inc';
include_once 'tm_status_updates.handle_remove.inc';
include_once 'tm_status_updates.handle_moderate.inc';
include_once 'tm_status_updates.handle_preview.inc';
include_once 'tm_status_updates.handle_promote.inc';
include_once 'tm_status_updates.render.inc';
include_once 'tm_status_updates.frontpage.inc';
include_once 'tm_status_updates.helpers.inc';
include_once 'tm_status_updates.post_form.inc';
include_once 'tm_status_updates.recommended.inc';
include_once 'tm_status_updates.view_count.inc';
include_once 'tm_status_updates.drush.inc';


/**
 * Implements hook_menu()
 */
function tm_status_updates_menu() {

  $items['newsfeed'] = array(
    'title' => 'News feed',
    'page callback' => 'tm_status_updates_display_newsfeed',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_display_callback',
    'type' => MENU_CALLBACK,
  );

  $items['newsfeed/global'] = array(
    'title' => 'Global news feed',
    'page callback' => 'tm_status_updates_display_global',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_display_callback',
    'type' => MENU_CALLBACK,
  );

  $items['newsfeed/tags/%'] = array(
    'title' => 'Tagged status updates',
    'page callback' => 'tm_status_updates_display_tags',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_display_callback',
    'type' => MENU_CALLBACK,
  );

  $items['newsfeed/nearby/%'] = array(
    'title' => 'Nearby status updates',
    'page callback' => 'tm_status_updates_display_nearby',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_display_callback',
    'type' => MENU_CALLBACK,
  );

  $items['newsfeed/load'] = array(
    'title' => 'Load more news feed',
    'page callback' => 'tm_status_updates_display_ajax',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_display_callback',
    'type' => MENU_CALLBACK,
  );

  $items['user/%user/status/update'] = array(
    'title' => 'Update status',
    'page callback' => 'tm_status_updates_update_status_ajax',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_update_status_check',
    'access arguments' => array(1),
    'type' => MENU_CALLBACK,
  );

  $items['user/%user/status/edit'] = array(
    'title' => 'Edit status',
    'page callback' => 'tm_status_updates_edit_status_ajax',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_edit_status_check',
    'access arguments' => array(1),
    'type' => MENU_CALLBACK,
  );

  $items['user/%user/status/edit_form'] = array(
    'title' => 'Edit form ajax',
    'page callback' => 'tm_status_updates_edit_form_ajax',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_edit_status_check',
    'access arguments' => array(1),
    'type' => MENU_CALLBACK,
  );

  $items['user/%user/status/preview_link'] = array(
    'title' => 'Preview URL',
    'page callback' => 'tm_status_updates_preview_link_ajax',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_preview_link_check',
    'access arguments' => array(1),
    'type' => MENU_CALLBACK,
  );

  $items['user/%user/status/remove'] = array(
    'title' => 'Remove status',
    'page callback' => 'tm_status_updates_remove_status_ajax',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_remove_status_check',
    'access arguments' => array(1),
    'type' => MENU_CALLBACK,
  );

  $items['user/%user/status/moderate'] = array(
    'title' => 'Moderate status',
    'page callback' => 'tm_status_updates_moderate_status_ajax',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_moderate_status_check',
    'access arguments' => array(1),
    'type' => MENU_CALLBACK,
  );

  $items['user/%user/status/promote'] = array(
    'title' => 'Promote status',
    'page callback' => 'tm_status_updates_promote_status_ajax',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_promote_status_check',
    'access arguments' => array(1),
    'type' => MENU_CALLBACK,
  );

  $items['user/%user/status/unpromote'] = array(
    'title' => 'Un-promote status',
    'page callback' => 'tm_status_updates_unpromote_status_ajax',
    'page arguments' => array(1),
    'access callback' => 'tm_status_updates_promote_status_check',
    'access arguments' => array(1),
    'type' => MENU_CALLBACK,
  );

  return $items;
}

/**
 * Approval callback for viewing newsfeed
 */
function tm_status_updates_display_callback() {
  return true;
}



